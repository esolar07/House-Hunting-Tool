<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Foundation</title>
    <link rel="stylesheet" href="css/app.css" />
    <script src="bower_components/modernizr/modernizr.js"></script>
  </head>
  <body>
    
    <header class="l-header" >
      <div class="nav-container">

        <div class="nav-title">
            <h1><a href="#">House Hunting </a></h1>
        </div>

        <nav class="nav-bar">
          <h3>Reference Sites</h3>
          <!-- Nav Section -->
          <ul class="navi">
            <li class="navi__item"><a href="http://miami.craigslist.org/search/apa" target="_blank">Craiglist</a></li>
            <li class="navi__item"><a href="http://www.trulia.com/FL/South_Florida/" target="_blank">Trulia</a></li>
            <li class="navi__item"><a href="http://hotpads.com/FL" target="_blank">Hotpads</a></li>
          </ul>
        </nav>
      
      </div>
    </header>

    <main class="l-main-container">
      <section class="pageSection">
      <form>
        <div class="f-box" id="drop">
          <h4>New Listing</h4>
          <input type="text" id="address" placeholder="Address">
          <input type="text" id="rooms" placeholder="Rooms">
          <input type="text" id="baths" placeholder="bathrooms">
          <input type="text" id="price" placeholder="Price">
          <button class="button" id="updateButton">Submit</button>
        </div>
        <div class="f-box-tab" onclick="toggle('drop');">
          <h4>Add a possible option</h4S>
        </div>
      </form>
      </section>

      <section id="mainSection" class="page-section">
        <h1>Possible Options</h1>
        <div class="page-section__item">
          <h2>Username</h2>
          <aside>
            
          </aside>
          <p>Non numquam eius modi tempora incidunt ut labore et dolore magnam aliquam quaerat voluptatem. At vero eos et accusamus. Accusantium doloremque laudantium, totam rem aperiam, eaque ipsa quae ab illo.</p>
        </div>
      </section>
    </main>

    <script src="bower_components/jquery/dist/jquery.min.js"></script>
    <script src="bower_components/foundation/js/foundation.min.js"></script>
    <script src="bower_components/foundation/js/foundation/foundation.top.js"></script>
    <script src="js/app.js"></script>
    <script src='https://cdn.firebase.com/js/client/2.0.4/firebase.js'></script>
    <script>

      // toggle function for  form
      function toggle(id){
        var e = document.getElementById(id);
        // if style is set to display none
        if(e.style.display == "none"){
          //then change to block
          e.style.display = "block";
          console.log("modified to display block");
          // otherwise display none
        }else{
          e.style.display = "none";
          console.log("modified to display none");
        }
      };


      var address = document.getElementById("address"),
      rooms = document.getElementById("rooms"),
      baths = document.getElementById("baths"),
      price = document.getElementById("price"),
      updateButton = document.getElementById("updateButton"),
      myDataRef = new Firebase('https://esolar.firebaseio.com/'),
      currentListRef = myDataRef.child("currentMesg");
      


      // event listener button for FireBase
      updateButton.addEventListener('click', function(){
        // updates db
        currentListRef.push({add: address.value, rooms: rooms.value, baths: baths.value, price: price.value});
        console.log("Added to FB-DB");
        //clears input fields after submitting
        address.value="";
        rooms.value="";
        baths.value="";
        price.value="";
      });

     // event listener for FireBase change
     currentListRef.on("child_added", function(snapshot){
      var listing = snapshot.val(); 
      displayListing(listing.address, listing.rooms);    
     });

     function displayListing(address, rooms){

      var newListing = document.getElementById("mainSection"),
      textnode = document.createTextNode(address),
      node = document.createElement("div");

      // appends to div to section
      newListing.appendChild(node);
      // adds class of "others" to new divs
      node.classList.add("others")
      node.appendChild(textnode);
      // adds to main section 
      console.log("change made on ui...");
     }

    </script>
  </body>
</html>
